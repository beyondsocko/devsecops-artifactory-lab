#!/bin/bash
set -e source .env echo "üèóÔ∏è Creating Nexus repositories..." 
# Function to create Docker hosted repository 
create_docker_repo() { local repo_name="$1" echo "Creating Docker repository: $repo_name"
curl -u "$NEXUS_USERNAME:$NEXUS_PASSWORD" \ -H "Content-Type: application/json" \ -X POST \ "$NEXUS_URL/service/rest/v1/repositories/docker/hosted" \ -d "{ \"name\": \"$repo_name\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true, \"writePolicy\": \"ALLOW\" }, \"docker\": { \"v1Enabled\": false, \"forceBasicAuth\": true, \"httpPort\": 8082 } }" } # Function to create Raw repository create_raw_repo() { local repo_name="$1" echo "Creating Raw repository: $repo_name" curl -u "$NEXUS_USERNAME:$NEXUS_PASSWORD" \ -H "Content-Type: application/json" \ -X POST \ "$NEXUS_URL/service/rest/v1/repositories/raw/hosted" \ -d "{ \"name\": \"$repo_name\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": false, \"writePolicy\": \"ALLOW\" } }" } # Create repositories create_docker_repo "docker-hosted" create_raw_repo "raw-hosted" echo "‚úÖ Repository creation complete!"
